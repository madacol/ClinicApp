{"ast":null,"code":"// src/pages/ExportarWord.js\nimport PizZip from \"pizzip\";\nimport Docxtemplater from \"docxtemplater\";\nimport { saveAs } from \"file-saver\";\nexport const exportToWord = async datosInforme => {\n  try {\n    const response = await fetch(\"/templates/plantilla.docx\");\n    const arrayBuffer = await response.arrayBuffer();\n    const zip = new PizZip(arrayBuffer);\n    const doc = new Docxtemplater(zip, {\n      paragraphLoop: true,\n      linebreaks: true\n    });\n    doc.render(datosInforme);\n    const out = doc.getZip().generate({\n      type: \"blob\",\n      mimeType: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n    });\n    saveAs(out, \"informe_medico.docx\");\n  } catch (error) {\n    console.error(\"Error al exportar el informe a Word:\", error);\n    window.alert(\"Error al exportar el informe a Word.\");\n  }\n};","map":{"version":3,"names":["PizZip","Docxtemplater","saveAs","exportToWord","datosInforme","response","fetch","arrayBuffer","zip","doc","paragraphLoop","linebreaks","render","out","getZip","generate","type","mimeType","error","console","window","alert"],"sources":["C:/Users/rc_sh/Desktop/Unidad oftalmologica/Clinica_rosmarian_castillo/frontend/src/pages/ExportarWord.js"],"sourcesContent":["// src/pages/ExportarWord.js\r\nimport PizZip from \"pizzip\";\r\nimport Docxtemplater from \"docxtemplater\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\nexport const exportToWord = async (datosInforme) => {\r\n  try {\r\n    const response = await fetch(\"/templates/plantilla.docx\");\r\n    const arrayBuffer = await response.arrayBuffer();\r\n    const zip = new PizZip(arrayBuffer);\r\n    const doc = new Docxtemplater(zip, {\r\n      paragraphLoop: true,\r\n      linebreaks: true,\r\n    });\r\n    doc.render(datosInforme);\r\n    const out = doc.getZip().generate({\r\n      type: \"blob\",\r\n      mimeType:\r\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\r\n    });\r\n    saveAs(out, \"informe_medico.docx\");\r\n  } catch (error) {\r\n    console.error(\"Error al exportar el informe a Word:\", error);\r\n    window.alert(\"Error al exportar el informe a Word.\");\r\n  }\r\n};\r\n"],"mappings":"AAAA;AACA,OAAOA,MAAM,MAAM,QAAQ;AAC3B,OAAOC,aAAa,MAAM,eAAe;AACzC,SAASC,MAAM,QAAQ,YAAY;AAEnC,OAAO,MAAMC,YAAY,GAAG,MAAOC,YAAY,IAAK;EAClD,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,2BAA2B,CAAC;IACzD,MAAMC,WAAW,GAAG,MAAMF,QAAQ,CAACE,WAAW,CAAC,CAAC;IAChD,MAAMC,GAAG,GAAG,IAAIR,MAAM,CAACO,WAAW,CAAC;IACnC,MAAME,GAAG,GAAG,IAAIR,aAAa,CAACO,GAAG,EAAE;MACjCE,aAAa,EAAE,IAAI;MACnBC,UAAU,EAAE;IACd,CAAC,CAAC;IACFF,GAAG,CAACG,MAAM,CAACR,YAAY,CAAC;IACxB,MAAMS,GAAG,GAAGJ,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC;MAChCC,IAAI,EAAE,MAAM;MACZC,QAAQ,EACN;IACJ,CAAC,CAAC;IACFf,MAAM,CAACW,GAAG,EAAE,qBAAqB,CAAC;EACpC,CAAC,CAAC,OAAOK,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;IAC5DE,MAAM,CAACC,KAAK,CAAC,sCAAsC,CAAC;EACtD;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}